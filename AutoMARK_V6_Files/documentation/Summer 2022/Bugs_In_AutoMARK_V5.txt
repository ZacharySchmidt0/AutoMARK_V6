Contributors: Zachary Schmidt, Jason Kim
Oversight: Dr. David Nobes
Summer 2022

Bugs found in AutoMARK V5 (changes made in V6):

createStudentPDF.m: lines 43-46
    strrep can only replace a string with another string. 
    The old item being replaced was of type datetime, not string.
    Fix: Convert the old datetime using datestr() after checking
    type

compareBalloon.m: line 21
    comparing bool and string using == led to typeError
    Fix: no need for == 'true'

key Macro: fillTableProperties subroutine
    Font info was being pulled in student macro but not in key macro.
    Copied into key macro and issue was fixed.

criterionDatumFilledTriangle.m: line 22
    Cannot use strcmp for data of type bool. Replace strcmp with xor.
    There were many other strcmp's that were replaced with xor in the
    MarkingCriterion folder.

compareBaloon.m: lines 60-65
    Notes with no text (the text was blank but there was text in the 
    SW drawing) were being labeled as missing. Commenting out these lines
    makes sure that all balloons/notes are evaluated.

MarkingTemplateGui.mlapp: anywhere with IndArr followed by Ind = IndArr(end)   (eg: lines 721-722)
    View names with a colon in the name were causing issues when 
    selecting different features in the modifying key template GUI.
    Searched for the last colon in the name rather than the first.

File Locations
    In V5, whenever a file had to be selected by the user, the dialog prompt
    would default by opening on the current working directory. We changed this
    so that all file selection prompts default to open one level above the 
    student folder. If no student folder is selected, the prompt will open
    in the current working directory.
    Changes: MarkingGui.mlapp unpackEclassZipButtonPushed(), LoadTemplateButtonPushed(),
             MakeTemplateButtonPushed(), RunSolidWorksMacroPushed. In all cases
             we passed a value for default file location to uigetfile or uiputfile.
             AutoMacroGUI.mlapp SelectFolderButtonPushed. Passed a value to uigetdir.

criterionDimensionValue.m: lines 25-35
	In V5, chamfer dimensions that were (180-key_angle) were being marked as wrong.
    Change was made to allow diff to be the lesser of student_angle or 180-student_angle.

makeTemplateFromKey.m line 209-219 and criterionCenterlinePosition.m line 11:
    Default key template assigned default tolerance box to be +/-0.003mm around the ends
    of each centerline. We changed this so that if the centerline is less than 45 degrees
    from horizontal, the tolerance box is +/-0.008mm in x and +/-0.002mm in y (vice versa for
    centerlines with an angle greater than 45 degreees from horizontal).

executeMarkingOnFolder.m line 59-69 & runMacros.m lines 76-86:
    This is where the "Estimated Time Remaining" feature is implemented. It works
    by using a stopwatch to calculate the average time to mark one student up to that
    point and multiplying this rate by the number of remaining students to get a 
    time estimate.

criterionDimensionArrowSide.m line 43:
    Previous coders assumed a dimension only has two arrowheads so all
    logical oeprators were &&. Change was made since a dimension might only
    have one arrowhead.
    Another change was made in the macros in the fillDimensionProperies subroutine
    where the same assumption was made when calculating dotArrowHead.
    The else branch was changed to simply used the built in .arrowSide.
